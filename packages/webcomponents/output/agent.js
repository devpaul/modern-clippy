!function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(o,r,function(e){return t[e]}.bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=8)}([function(t,e,n){"use strict";(function(t){const n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:void 0;e.a=n}).call(this,n(3))},function(t,e,n){"use strict";var o=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{l(o.next(t))}catch(t){i(t)}}function s(t){try{l(o.throw(t))}catch(t){i(t)}}function l(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}l((o=o.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const r=n(6),i=n(2),a=n(4).default,s=n(5);function l(t,e){if(null==t)throw new Error(e);return t}e.Agent=class extends HTMLElement{constructor(){super(),this._mute=!1;const t=this.attachShadow({mode:"open"}),e=document.createElement("template");e.innerHTML=s;const n=e.content.cloneNode(!0);this._overlays=l(n.querySelector("#overlays"),"missing overlay container"),this._speech=l(n.querySelector("#speech"),"missing speech container"),l(n.querySelector("slot"),"missing slot").addEventListener("slotchange",t=>{this._onSlotChange(t)});const o=document.createElement("style");o.textContent=a,t.appendChild(o),t.appendChild(n)}static get observedAttributes(){return["bundle","mute"]}get actions(){return Object.keys(this._config.animations)}get current(){return this._control&&this._control.action}attributeChangedCallback(t,e,n){switch(t){case"bundle":this.load(n);break;case"mute":this._mute="true"===n}}load(t){return o(this,void 0,void 0,function*(){if("string"==typeof t){console.log(`loading ${t} bundle`);const e=yield fetch(t);t=yield e.json()}for(this._config=t;this._overlays.firstChild;)this._overlays.removeChild(this._overlays.firstChild);for(let e=t.overlayCount;e>0;e--)this._createOverlay();this._overlays.style.height=t.frameSize.height+"px",this._overlays.style.width=t.frameSize.width+"px",this._soundBoard=yield i.default.load(t.soundPack),this.play("Show")})}play(t){const e=this._config.animations[t];if(!e)throw new Error(`Action ${t} does not exist`);this._control&&this._control.stopImmediately(),this.dispatchEvent(new CustomEvent("actionStart",{detail:{action:t}}));let n=0;return this._control=Object.assign({action:t},r.animator(e,e=>{const{images:o=[]}=e;this._setFrames(o);for(let t=o.length;t<this._config.overlayCount;t++)this._hideFrame(t);!this._mute&&e.sound&&this._soundBoard.play(String(e.sound)),this.dispatchEvent(new CustomEvent("frame",{detail:{action:t,frame:e,time:n}})),n+=e.duration})),this._control.done.finally(()=>{this.dispatchEvent(new CustomEvent("actionEnd",{detail:{action:t}})),this._control=void 0}),this._control}playIdle(){const t=this.actions.filter(t=>"Idle"===t.substr(0,4));this.play(t[Math.floor(Math.random()*t.length)])}stop(){this._control&&this._control.stop()}stopImmediately(){this._control&&this._control.stopImmediately()}_createOverlay(){const{characterMap:t,frameSize:{width:e,height:n}}=this._config,o=document.createElement("div");o.style.width=e+"px",o.style.height=n+"px",o.style.backgroundImage=`url(${t})`,o.style.display="none",this._overlays.appendChild(o)}_hideFrame(t=0){const e=this._overlays.children[t];e&&(e.style.display="none")}_onSlotChange(t){const e=t.target;this._speech.style.visibility=e.assignedElements().length?"visible":"hidden",this._speech.style.left=.75*this._config.frameSize.width+"px"}_setFrame(t,e,n=0){const{width:o,height:r}=this._config.frameSize,i=this._overlays.children[n];if(t%o==0&&e%r==0||console.warn(`frame ${t},${e} is not a multiple of frame size ${o},${r}`),!i)throw new Error(`Missing overlay ${n}`);i.style.display="block",i.style.backgroundPositionX=-t+"px",i.style.backgroundPositionY=-e+"px",i.style.position="absolute",i.style.top="0",i.style.left="0"}_setFrames(t){if(t)for(let e=0;e<t.length;e++){const[n,o]=t[e];this._setFrame(n,o,e)}}}},function(t,e,n){"use strict";n.r(e),n.d(e,"SoundBoard",function(){return l}),n.d(e,"CoreAudio",function(){return c});var o=n(0),r=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{l(o.next(t))}catch(t){i(t)}}function s(t){try{l(o.throw(t))}catch(t){i(t)}}function l(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}l((o=o.apply(t,e||[])).next())})};const i=o.a.AudioContext||o.a.webkitAudioContext,a=new Map([["mp3","audio/mpeg"],["ogg","audio/ogg"]]),s=document.createElement("audio");class l{constructor(t,e){this.context=t,this.effects=e}play(t){const e=this.effects[t];if(e){"suspended"===this.context.state&&this.context.resume();const t=this.context.createBufferSource();t.buffer=e,t.connect(this.context.destination),t.start()}else console.warn(`Soundboard missing effect for ${t}`)}}class c{constructor(t=new i){this.context=t}get suspended(){return"suspended"===this.context.state}resume(){this.context.resume()}load(t){return r(this,void 0,void 0,function*(){const e={};return Object.keys(t).forEach(n=>r(this,void 0,void 0,function*(){const o=t[n];this.canPlay(n)&&(console.log("loading "+n),yield this.loadSoundPack(e,o))})),new l(this.context,e)})}loadSound(t){return r(this,void 0,void 0,function*(){const e=yield fetch(t),n=yield e.arrayBuffer();return this.context.decodeAudioData(n)})}canPlay(t){const e=a.get(t)||t;return s.canPlayType(e)}loadSoundPack(t,e){return Promise.all(Object.keys(e).map(n=>r(this,void 0,void 0,function*(){if(!t[n])try{t[n]=yield this.loadSound(e[n])}catch(t){console.warn(`failed to load audio ${n}`)}})))}}e.default=new c},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";n.r(e),e.default=':host {\n\t--bg-color: #FFC;\n\t--border-color: black;\n\t--text-color: #333;\n\t--triangle-height: 13px;\n\t--triangle-base: 26px;\n\t--triangle-placement: 40px;\n\t--triangle-vertical-placement: 10px;\n\t--triangle-border: 1px;\n\t--speech-min-width: 40px;\n\t--speech-min-height: 40px;\n}\n\n.root {\n\tposition: relative;\n}\n\n#overlays {\n\tposition: relative;\n}\n\n#overlays > * {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n}\n\n/* =========================================================================================================\n * SPEECH BUBBLE\n*/\n\n#speech {\n\tvisibility: hidden;\n\tposition: absolute;\n\tdisplay: block;\n\tz-index: 1000;\n\tmin-width: var(--speech-min-width);\n\tmin-height: var(--speech-min-height)\n}\n\n.bubble {\n\tposition: relative;\n\tpadding: 15px;\n\tmargin: 1em 0 3em;\n\tborder: var(--triangle-border) solid var(--border-color);\n\tcolor: var(--text-color);\n\tbackground: var(--bg-color);\n\tborder-radius: 10px;\n}\n\n/* BOTTOM TRIANGLE */\n\n/* outer triangle border */\n.bottom.bubble:before {\n\tcontent: "";\n\tposition: absolute;\n\tbottom: calc(-1 * (var(--triangle-height) + var(--triangle-border)));\n\tleft: var(--triangle-placement);\n\tborder-width: calc(var(--triangle-height) + var(--triangle-border)) calc(var(--triangle-border) + var(--triangle-base) / 2) 0;\n\tborder-style: solid;\n\tborder-color: var(--border-color) transparent;\n}\n\n/* creates the smaller  triangle */\n.bottom.bubble:after {\n\tcontent: "";\n\tposition: absolute;\n\tbottom: calc(-1 * var(--triangle-height));\n\tleft: calc(var(--triangle-placement) + var(--triangle-border));\n\tborder-width: var(--triangle-height) calc(var(--triangle-base) / 2) 0;\n\tborder-style: solid;\n\tborder-color: var(--bg-color) transparent;\n}\n\n/* LEFT TRIANGLE */\n\n.left.bubble:before {\n\tcontent: "";\n\tposition: absolute;\n\ttop: var(--triangle-vertical-placement);\n\tleft: calc(-1 * (var(--triangle-height) + var(--triangle-border)));\n\tborder-width: calc(var(--triangle-border) + var(--triangle-base) / 2) calc(var(--triangle-height) + var(--triangle-border)) calc(var(--triangle-border) + var(--triangle-base) / 2) 0;\n\tborder-style: solid;\n\tborder-color: transparent var(--border-color) transparent;\n}\n\n.left.bubble:after {\n\tcontent: "";\n\tposition: absolute;\n\ttop: calc(var(--triangle-vertical-placement) + var(--triangle-border));\n\tleft: calc(-1 * var(--triangle-height));\n\tborder-width: 50px 145px 50px 0;\n\tborder-width: calc(var(--triangle-base) / 2) var(--triangle-height) calc(var(--triangle-base) / 2) 0;\n\tborder-style: solid;\n\tborder-color: transparent var(--bg-color) transparent;\n}\n\n/* RIGHT TRIANGLE */\n\n/* TOP TRIANGLE */\n\n.speech-bubble-left:after {\n\tcontent: \'\';\n\tposition: absolute;\n\tright: 0;\n\ttop: 50%;\n\twidth: 0;\n\theight: 0;\n\tborder: 20px solid transparent;\n\tborder-left-color: #ffffbb;\n\tborder-right: 0;\n\tborder-bottom: 0;\n\tmargin-top: -10px;\n\tmargin-right: -20px;\n}\n'},function(t,e){t.exports='<div class=root> <div id=speech class="bubble left"> <slot name=""> </slot> </div> <div id=overlays> </div> </div> '},function(t,e,n){"use strict";function o(t){return new Promise(e=>{setTimeout(e,t)})}n.r(e),n.d(e,"stepper",function(){return a}),n.d(e,"animator",function(){return s});var r=function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{l(o.next(t))}catch(t){i(t)}}function s(t){try{l(o.throw(t))}catch(t){i(t)}}function l(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}l((o=o.apply(t,e||[])).next())})};function i(t){let e=100*Math.random();for(const n of t)if((e-=n.weight)<=0)return n.frameIndex}function*a(t){let e=0,n=t.frames,o=!1;for(;e<n.length;){let t=n[e];(o=!!(yield t)||o)&&t.exitBranch?e=t.exitBranch:t.branching?e=i(t.branching.branches)||e+1:e++}}function s(t,e){const n=a(t);let i,s=!1,l=!1;const c=Promise.race([(()=>r(this,void 0,void 0,function*(){for(let{done:t,value:r}=n.next(s);!l&&!t;({done:t,value:r}=n.next(s)))e(r),yield o(r.duration)}))(),new Promise(t=>{i=t})]);return{done:c,stop:()=>(s=!1,c),stopImmediately(){l=!0,i()}}}},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o=n(1);customElements.define("modern-agent",o.Agent),e.default=o.Agent}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4uL2NvbW1vbi9vdXRwdXQvZXNtL3V0aWwvZ2xvYmFsLmpzIiwid2VicGFjazovLy8uL3NyYy9hZ2VudC50cyIsIndlYnBhY2s6Ly8vLi4vY29tbW9uL291dHB1dC9lc20vY29yZUF1ZGlvLmpzIiwid2VicGFjazovLy8od2VicGFjaykvYnVpbGRpbi9nbG9iYWwuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2FnZW50LmNzcyIsIndlYnBhY2s6Ly8vLi9zcmMvYWdlbnQuaHRtbCIsIndlYnBhY2s6Ly8vLi4vY29tbW9uL291dHB1dC9lc20vdXRpbC9zbGVlcC5qcyIsIndlYnBhY2s6Ly8vLi4vY29tbW9uL291dHB1dC9lc20vYW5pbWF0b3IuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2luZGV4LnRzIl0sIm5hbWVzIjpbImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJleHBvcnRzIiwibW9kdWxlIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiZ2xvYmFsIiwiZ2xvYmFsT2JqZWN0Iiwic2VsZiIsIndpbmRvdyIsIl9fd2VicGFja19leHBvcnRzX18iLCJhbmltYXRvcl8xIiwiY29yZUF1ZGlvXzEiLCJhZ2VudFN0eWxlIiwiZGVmYXVsdCIsInRlbXBsYXRlU3RyaW5nIiwidGhyb3dJZk51bGwiLCJtZXNzYWdlIiwiRXJyb3IiLCJBZ2VudCIsIkhUTUxFbGVtZW50IiwiW29iamVjdCBPYmplY3RdIiwic3VwZXIiLCJ0aGlzIiwiX211dGUiLCJzaGFkb3ciLCJhdHRhY2hTaGFkb3ciLCJ0ZW1wbGF0ZSIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsInJvb3QiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX292ZXJsYXlzIiwicXVlcnlTZWxlY3RvciIsIl9zcGVlY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJfb25TbG90Q2hhbmdlIiwic3R5bGUiLCJ0ZXh0Q29udGVudCIsImFwcGVuZENoaWxkIiwib2JzZXJ2ZWRBdHRyaWJ1dGVzIiwiYWN0aW9ucyIsImtleXMiLCJfY29uZmlnIiwiYW5pbWF0aW9ucyIsImN1cnJlbnQiLCJfY29udHJvbCIsImFjdGlvbiIsIl9vbGRWYWx1ZSIsIm5ld1ZhbHVlIiwibG9hZCIsImNvbmZpZyIsImNvbnNvbGUiLCJsb2ciLCJyZXN1bHQiLCJmZXRjaCIsImpzb24iLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJvdmVybGF5Q291bnQiLCJfY3JlYXRlT3ZlcmxheSIsImhlaWdodCIsImZyYW1lU2l6ZSIsIndpZHRoIiwiX3NvdW5kQm9hcmQiLCJzb3VuZFBhY2siLCJwbGF5IiwiYW5pbWF0aW9uIiwic3RvcEltbWVkaWF0ZWx5IiwiZGlzcGF0Y2hFdmVudCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwidGltZSIsImFzc2lnbiIsImFuaW1hdG9yIiwiZnJhbWUiLCJpbWFnZXMiLCJfc2V0RnJhbWVzIiwibGVuZ3RoIiwiX2hpZGVGcmFtZSIsInNvdW5kIiwiU3RyaW5nIiwiZHVyYXRpb24iLCJkb25lIiwiZmluYWxseSIsInVuZGVmaW5lZCIsImlkbGVBY3Rpb25zIiwiZmlsdGVyIiwic3Vic3RyIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3RvcCIsImNoYXJhY3Rlck1hcCIsIm92ZXJsYXkiLCJiYWNrZ3JvdW5kSW1hZ2UiLCJkaXNwbGF5Iiwibm9kZSIsImNoaWxkcmVuIiwic2xvdCIsInRhcmdldCIsInZpc2liaWxpdHkiLCJhc3NpZ25lZEVsZW1lbnRzIiwibGVmdCIsIngiLCJ5Iiwid2FybiIsImJhY2tncm91bmRQb3NpdGlvblgiLCJiYWNrZ3JvdW5kUG9zaXRpb25ZIiwicG9zaXRpb24iLCJ0b3AiLCJfc2V0RnJhbWUiLCJTb3VuZEJvYXJkIiwiQ29yZUF1ZGlvIiwiX3V0aWxfZ2xvYmFsX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwidGhlbiIsImFwcGx5IiwiQXVkaW9Db250ZXh0Iiwid2Via2l0QXVkaW9Db250ZXh0IiwibWltZU1hcCIsIk1hcCIsImF1ZGlvVGFnIiwiY29udGV4dCIsImVmZmVjdHMiLCJidWZmZXIiLCJzdGF0ZSIsInJlc3VtZSIsInNvdXJjZSIsImNyZWF0ZUJ1ZmZlclNvdXJjZSIsImNvbm5lY3QiLCJkZXN0aW5hdGlvbiIsInN0YXJ0Iiwic3VzcGVuZGVkIiwiZm9yRWFjaCIsInR5cGUiLCJwYWNrIiwiY2FuUGxheSIsImxvYWRTb3VuZFBhY2siLCJzcmMiLCJkYXRhIiwiYXJyYXlCdWZmZXIiLCJkZWNvZGVBdWRpb0RhdGEiLCJmb3JtYXQiLCJtaW1ldHlwZSIsImNhblBsYXlUeXBlIiwiYWxsIiwibWFwIiwiaWQiLCJsb2FkU291bmQiLCJnIiwiRnVuY3Rpb24iLCJzbGVlcCIsIm1pbGxpc2Vjb25kcyIsInNldFRpbWVvdXQiLCJzdGVwcGVyIiwicGlja1JhbmRvbSIsImJyYW5jaGVzIiwicGljayIsImJyYW5jaCIsIndlaWdodCIsImZyYW1lSW5kZXgiLCJvZmZzZXQiLCJmcmFtZXMiLCJleGl0IiwiZXhpdEJyYW5jaCIsImJyYW5jaGluZyIsImZyYW1lQ2FsbGJhY2siLCJpdGVyYXRvciIsImNhbGxJbW1lZGlhdGUiLCJpbW1lZGlhdGUiLCJyYWNlIiwiYWdlbnRfMSIsImN1c3RvbUVsZW1lbnRzIiwiZGVmaW5lIl0sIm1hcHBpbmdzIjoiYUFDQSxJQUFBQSxFQUFBLEdBR0EsU0FBQUMsRUFBQUMsR0FHQSxHQUFBRixFQUFBRSxHQUNBLE9BQUFGLEVBQUFFLEdBQUFDLFFBR0EsSUFBQUMsRUFBQUosRUFBQUUsR0FBQSxDQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFFBQUEsSUFVQSxPQU5BSSxFQUFBTCxHQUFBTSxLQUFBSixFQUFBRCxRQUFBQyxJQUFBRCxRQUFBRixHQUdBRyxFQUFBRSxHQUFBLEVBR0FGLEVBQUFELFFBS0FGLEVBQUFRLEVBQUFGLEVBR0FOLEVBQUFTLEVBQUFWLEVBR0FDLEVBQUFVLEVBQUEsU0FBQVIsRUFBQVMsRUFBQUMsR0FDQVosRUFBQWEsRUFBQVgsRUFBQVMsSUFDQUcsT0FBQUMsZUFBQWIsRUFBQVMsRUFBQSxDQUEwQ0ssWUFBQSxFQUFBQyxJQUFBTCxLQUsxQ1osRUFBQWtCLEVBQUEsU0FBQWhCLEdBQ0Esb0JBQUFpQixlQUFBQyxhQUNBTixPQUFBQyxlQUFBYixFQUFBaUIsT0FBQUMsWUFBQSxDQUF3REMsTUFBQSxXQUV4RFAsT0FBQUMsZUFBQWIsRUFBQSxjQUFpRG1CLE9BQUEsS0FRakRyQixFQUFBc0IsRUFBQSxTQUFBRCxFQUFBRSxHQUVBLEdBREEsRUFBQUEsSUFBQUYsRUFBQXJCLEVBQUFxQixJQUNBLEVBQUFFLEVBQUEsT0FBQUYsRUFDQSxLQUFBRSxHQUFBLGlCQUFBRixRQUFBRyxXQUFBLE9BQUFILEVBQ0EsSUFBQUksRUFBQVgsT0FBQVksT0FBQSxNQUdBLEdBRkExQixFQUFBa0IsRUFBQU8sR0FDQVgsT0FBQUMsZUFBQVUsRUFBQSxXQUF5Q1QsWUFBQSxFQUFBSyxVQUN6QyxFQUFBRSxHQUFBLGlCQUFBRixFQUFBLFFBQUFNLEtBQUFOLEVBQUFyQixFQUFBVSxFQUFBZSxFQUFBRSxFQUFBLFNBQUFBLEdBQWdILE9BQUFOLEVBQUFNLElBQXFCQyxL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R0FDQSxJQUVBa0gsRUFGQUwsR0FBQSxFQUNBTSxHQUFBLEVBRUEsTUFBQW5HLEVBQUFxQyxRQUFBK0QsS0FBQSxDQUNBLEtBQUFwRSxFQUFBL0YsVUFBQSxxQkFDQSxRQUFBK0QsS0FBc0JBLEVBQUEvRixNQUFBdUYsR0FBcUJ5RyxFQUFBdkQsS0FBQW1ELElBQXVCTSxJQUFBbkcsSUFBdUJBLE9BQUEvRixNQUFBdUYsR0FBcUJ5RyxFQUFBdkQsS0FBQW1ELElBQzlHRyxFQUFBeEcsU0FDc0J5RixFQUFLekYsRUFBQU8sWUFIM0IsR0FNQSxJQUFBc0MsUUFBQWxFLElBQ0ErSCxFQUFBL0gsTUFHQSxPQUNBNkIsT0FDQVMsS0FBQSxLQUNBb0YsR0FBQSxFQUNBN0YsR0FFQWpFLGtCQUNBb0ssR0FBQSxFQUNBRCx1RkM1REEsTUFBQUcsRUFBQXpOLEVBQUEsR0FFQTBOLGVBQWVDLE9BQU8sZUFBZ0JGLEVBQUF4SyxPQUV0Qy9DLEVBQUEwQyxRQUFlNkssRUFBQXhLIiwiZmlsZSI6ImFnZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDgpO1xuIiwiY29uc3QgZ2xvYmFsT2JqZWN0ID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIC8vIHRoZSBvbmx5IHJlbGlhYmxlIG1lYW5zIHRvIGdldCB0aGUgZ2xvYmFsIG9iamVjdCBpc1xyXG4gICAgLy8gYEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKClgXHJcbiAgICAvLyBIb3dldmVyLCB0aGlzIGNhdXNlcyBDU1AgdmlvbGF0aW9ucyBpbiBDaHJvbWUgYXBwcy5cclxuICAgIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICByZXR1cm4gc2VsZjtcclxuICAgIH1cclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIHJldHVybiB3aW5kb3c7XHJcbiAgICB9XHJcbiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcpIHtcclxuICAgICAgICByZXR1cm4gZ2xvYmFsO1xyXG4gICAgfVxyXG59KSgpO1xyXG5leHBvcnQgZGVmYXVsdCBnbG9iYWxPYmplY3Q7XHJcbiIsImltcG9ydCB7IEFnZW50Q29uZmlndXJhdGlvbiwgRnJhbWVJbWFnZXMgfSBmcm9tICdtb2Rlcm4tY2xpcHB5JztcbmltcG9ydCB7IGFuaW1hdG9yIH0gZnJvbSAnLi4vLi4vY29tbW9uL291dHB1dC9lc20vYW5pbWF0b3InO1xuaW1wb3J0IGF1ZGlvLCB7IFNvdW5kQm9hcmQgfSBmcm9tICcuLi8uLi9jb21tb24vb3V0cHV0L2VzbS9jb3JlQXVkaW8nO1xuXG5jb25zdCBhZ2VudFN0eWxlOiBzdHJpbmcgPSByZXF1aXJlKCcuL2FnZW50LmNzcycpLmRlZmF1bHQ7XG5jb25zdCB0ZW1wbGF0ZVN0cmluZzogc3RyaW5nID0gcmVxdWlyZSgnLi9hZ2VudC5odG1sJyk7XG5cbmZ1bmN0aW9uIHRocm93SWZOdWxsPFQgPSBhbnk+KHZhbHVlOiBUIHwgbnVsbCB8IHVuZGVmaW5lZCwgbWVzc2FnZTogc3RyaW5nKTogVCB7XG5cdGlmICh2YWx1ZSA9PSBudWxsKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKG1lc3NhZ2UpO1xuXHR9XG5cdHJldHVybiB2YWx1ZTtcbn1cblxuZXhwb3J0IGNsYXNzIEFnZW50IGV4dGVuZHMgSFRNTEVsZW1lbnQge1xuXHRwcml2YXRlIF9vdmVybGF5czogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgX3NwZWVjaDogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgX2NvbmZpZyE6IEFnZW50Q29uZmlndXJhdGlvbjtcblx0cHJpdmF0ZSBfY29udHJvbD86IFJldHVyblR5cGU8dHlwZW9mIGFuaW1hdG9yPiAmIHsgYWN0aW9uOiBzdHJpbmcgfTtcblx0cHJpdmF0ZSBfbXV0ZSA9IGZhbHNlO1xuXHRwcml2YXRlIF9zb3VuZEJvYXJkITogU291bmRCb2FyZDtcblxuXHRzdGF0aWMgZ2V0IG9ic2VydmVkQXR0cmlidXRlcygpIHtcblx0XHRyZXR1cm4gWydidW5kbGUnLCAnbXV0ZSddO1xuXHR9XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0c3VwZXIoKTtcblxuXHRcdGNvbnN0IHNoYWRvdyA9IHRoaXMuYXR0YWNoU2hhZG93KHsgbW9kZTogJ29wZW4nIH0pO1xuXG5cdFx0Y29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZW1wbGF0ZScpO1xuXHRcdHRlbXBsYXRlLmlubmVySFRNTCA9IHRlbXBsYXRlU3RyaW5nO1xuXHRcdGNvbnN0IHJvb3QgPSB0ZW1wbGF0ZS5jb250ZW50LmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudDtcblxuXHRcdHRoaXMuX292ZXJsYXlzID0gdGhyb3dJZk51bGwocm9vdC5xdWVyeVNlbGVjdG9yKCcjb3ZlcmxheXMnKSwgJ21pc3Npbmcgb3ZlcmxheSBjb250YWluZXInKSBhcyBIVE1MRWxlbWVudDtcblx0XHR0aGlzLl9zcGVlY2ggPSB0aHJvd0lmTnVsbChyb290LnF1ZXJ5U2VsZWN0b3IoJyNzcGVlY2gnKSwgJ21pc3Npbmcgc3BlZWNoIGNvbnRhaW5lcicpIGFzIEhUTUxFbGVtZW50O1xuXHRcdHRocm93SWZOdWxsKHJvb3QucXVlcnlTZWxlY3Rvcignc2xvdCcpLCAnbWlzc2luZyBzbG90JykuYWRkRXZlbnRMaXN0ZW5lcignc2xvdGNoYW5nZScsIChldmVudCkgPT4ge1xuXHRcdFx0dGhpcy5fb25TbG90Q2hhbmdlKGV2ZW50KTtcblx0XHR9KTtcblxuXHRcdGNvbnN0IHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTtcblx0XHRzdHlsZS50ZXh0Q29udGVudCA9IGFnZW50U3R5bGU7XG5cblx0XHRzaGFkb3cuYXBwZW5kQ2hpbGQoc3R5bGUpO1xuXHRcdHNoYWRvdy5hcHBlbmRDaGlsZChyb290KTtcblx0fVxuXG5cdGdldCBhY3Rpb25zKCk6IHN0cmluZ1tdIHtcblx0XHRyZXR1cm4gT2JqZWN0LmtleXModGhpcy5fY29uZmlnLmFuaW1hdGlvbnMpO1xuXHR9XG5cblx0Z2V0IGN1cnJlbnQoKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcblx0XHRyZXR1cm4gdGhpcy5fY29udHJvbCAmJiB0aGlzLl9jb250cm9sLmFjdGlvbjtcblx0fVxuXG5cdGF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayhuYW1lOiBzdHJpbmcsIF9vbGRWYWx1ZTogc3RyaW5nLCBuZXdWYWx1ZTogc3RyaW5nKSB7XG5cdFx0c3dpdGNoIChuYW1lKSB7XG5cdFx0XHRjYXNlICdidW5kbGUnOlxuXHRcdFx0XHR0aGlzLmxvYWQobmV3VmFsdWUpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ211dGUnOlxuXHRcdFx0XHR0aGlzLl9tdXRlID0gbmV3VmFsdWUgPT09ICd0cnVlJztcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cblx0YXN5bmMgbG9hZChjb25maWc6IEFnZW50Q29uZmlndXJhdGlvbiB8IHN0cmluZykge1xuXHRcdGlmICh0eXBlb2YgY29uZmlnID09PSAnc3RyaW5nJykge1xuXHRcdFx0Y29uc29sZS5sb2coYGxvYWRpbmcgJHtjb25maWd9IGJ1bmRsZWApO1xuXHRcdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgZmV0Y2goY29uZmlnKTtcblx0XHRcdGNvbmZpZyA9IChhd2FpdCByZXN1bHQuanNvbigpKSBhcyBBZ2VudENvbmZpZ3VyYXRpb247XG5cdFx0fVxuXHRcdHRoaXMuX2NvbmZpZyA9IGNvbmZpZztcblx0XHR3aGlsZSAodGhpcy5fb3ZlcmxheXMuZmlyc3RDaGlsZCkge1xuXHRcdFx0dGhpcy5fb3ZlcmxheXMucmVtb3ZlQ2hpbGQodGhpcy5fb3ZlcmxheXMuZmlyc3RDaGlsZCk7XG5cdFx0fVxuXHRcdGZvciAobGV0IGkgPSBjb25maWcub3ZlcmxheUNvdW50OyBpID4gMDsgaS0tKSB7XG5cdFx0XHR0aGlzLl9jcmVhdGVPdmVybGF5KCk7XG5cdFx0fVxuXHRcdHRoaXMuX292ZXJsYXlzLnN0eWxlLmhlaWdodCA9IGNvbmZpZy5mcmFtZVNpemUuaGVpZ2h0ICsgJ3B4Jztcblx0XHR0aGlzLl9vdmVybGF5cy5zdHlsZS53aWR0aCA9IGNvbmZpZy5mcmFtZVNpemUud2lkdGggKyAncHgnO1xuXHRcdHRoaXMuX3NvdW5kQm9hcmQgPSBhd2FpdCBhdWRpby5sb2FkKGNvbmZpZy5zb3VuZFBhY2spO1xuXHRcdHRoaXMucGxheSgnU2hvdycpO1xuXHR9XG5cblx0cGxheShhY3Rpb246IHN0cmluZykge1xuXHRcdGNvbnN0IGFuaW1hdGlvbiA9IHRoaXMuX2NvbmZpZy5hbmltYXRpb25zW2FjdGlvbl07XG5cdFx0aWYgKCFhbmltYXRpb24pIHtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgQWN0aW9uICR7YWN0aW9ufSBkb2VzIG5vdCBleGlzdGApO1xuXHRcdH1cblx0XHR0aGlzLl9jb250cm9sICYmIHRoaXMuX2NvbnRyb2wuc3RvcEltbWVkaWF0ZWx5KCk7XG5cdFx0dGhpcy5kaXNwYXRjaEV2ZW50KFxuXHRcdFx0bmV3IEN1c3RvbUV2ZW50KCdhY3Rpb25TdGFydCcsIHtcblx0XHRcdFx0ZGV0YWlsOiB7IGFjdGlvbiB9XG5cdFx0XHR9KVxuXHRcdCk7XG5cdFx0bGV0IHRpbWUgPSAwO1xuXHRcdHRoaXMuX2NvbnRyb2wgPSB7XG5cdFx0XHRhY3Rpb24sXG5cdFx0XHQuLi5hbmltYXRvcihhbmltYXRpb24sIChmcmFtZSkgPT4ge1xuXHRcdFx0XHRjb25zdCB7IGltYWdlcyA9IFtdIH0gPSBmcmFtZTtcblx0XHRcdFx0dGhpcy5fc2V0RnJhbWVzKGltYWdlcyk7XG5cdFx0XHRcdGZvciAobGV0IGkgPSBpbWFnZXMubGVuZ3RoOyBpIDwgdGhpcy5fY29uZmlnLm92ZXJsYXlDb3VudDsgaSsrKSB7XG5cdFx0XHRcdFx0dGhpcy5faGlkZUZyYW1lKGkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghdGhpcy5fbXV0ZSAmJiBmcmFtZS5zb3VuZCkge1xuXHRcdFx0XHRcdHRoaXMuX3NvdW5kQm9hcmQucGxheShTdHJpbmcoZnJhbWUuc291bmQpKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR0aGlzLmRpc3BhdGNoRXZlbnQoXG5cdFx0XHRcdFx0bmV3IEN1c3RvbUV2ZW50KCdmcmFtZScsIHtcblx0XHRcdFx0XHRcdGRldGFpbDogeyBhY3Rpb24sIGZyYW1lLCB0aW1lIH1cblx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXHRcdFx0XHR0aW1lICs9IGZyYW1lLmR1cmF0aW9uO1xuXHRcdFx0fSlcblx0XHR9O1xuXHRcdHRoaXMuX2NvbnRyb2wuZG9uZS5maW5hbGx5KCgpID0+IHtcblx0XHRcdHRoaXMuZGlzcGF0Y2hFdmVudChcblx0XHRcdFx0bmV3IEN1c3RvbUV2ZW50KCdhY3Rpb25FbmQnLCB7XG5cdFx0XHRcdFx0ZGV0YWlsOiB7IGFjdGlvbiB9XG5cdFx0XHRcdH0pXG5cdFx0XHQpO1xuXHRcdFx0dGhpcy5fY29udHJvbCA9IHVuZGVmaW5lZDtcblx0XHR9KTtcblx0XHRyZXR1cm4gdGhpcy5fY29udHJvbDtcblx0fVxuXG5cdHBsYXlJZGxlKCkge1xuXHRcdGNvbnN0IGlkbGVBY3Rpb25zID0gdGhpcy5hY3Rpb25zLmZpbHRlcigoYWN0aW9uKSA9PiBhY3Rpb24uc3Vic3RyKDAsIDQpID09PSAnSWRsZScpO1xuXHRcdHRoaXMucGxheShpZGxlQWN0aW9uc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBpZGxlQWN0aW9ucy5sZW5ndGgpXSk7XG5cdH1cblxuXHRzdG9wKCkge1xuXHRcdHRoaXMuX2NvbnRyb2wgJiYgdGhpcy5fY29udHJvbC5zdG9wKCk7XG5cdH1cblxuXHRzdG9wSW1tZWRpYXRlbHkoKSB7XG5cdFx0dGhpcy5fY29udHJvbCAmJiB0aGlzLl9jb250cm9sLnN0b3BJbW1lZGlhdGVseSgpO1xuXHR9XG5cblx0cHJpdmF0ZSBfY3JlYXRlT3ZlcmxheSgpIHtcblx0XHRjb25zdCB7XG5cdFx0XHRjaGFyYWN0ZXJNYXAsXG5cdFx0XHRmcmFtZVNpemU6IHsgd2lkdGgsIGhlaWdodCB9XG5cdFx0fSA9IHRoaXMuX2NvbmZpZztcblx0XHRjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG5cdFx0b3ZlcmxheS5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4Jztcblx0XHRvdmVybGF5LnN0eWxlLmhlaWdodCA9IGhlaWdodCArICdweCc7XG5cdFx0b3ZlcmxheS5zdHlsZS5iYWNrZ3JvdW5kSW1hZ2UgPSBgdXJsKCR7Y2hhcmFjdGVyTWFwfSlgO1xuXHRcdG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblx0XHR0aGlzLl9vdmVybGF5cy5hcHBlbmRDaGlsZChvdmVybGF5KTtcblx0fVxuXG5cdHByaXZhdGUgX2hpZGVGcmFtZShvdmVybGF5OiBudW1iZXIgPSAwKSB7XG5cdFx0Y29uc3Qgbm9kZSA9IHRoaXMuX292ZXJsYXlzLmNoaWxkcmVuW292ZXJsYXldIGFzIEhUTUxFbGVtZW50O1xuXHRcdG5vZGUgJiYgKG5vZGUuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7XG5cdH1cblxuXHRwcml2YXRlIF9vblNsb3RDaGFuZ2UoZXZlbnQ6IEV2ZW50KSB7XG5cdFx0Y29uc3Qgc2xvdCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MU2xvdEVsZW1lbnQ7XG5cdFx0dGhpcy5fc3BlZWNoLnN0eWxlLnZpc2liaWxpdHkgPSBzbG90LmFzc2lnbmVkRWxlbWVudHMoKS5sZW5ndGggPyAndmlzaWJsZScgOiAnaGlkZGVuJztcblx0XHR0aGlzLl9zcGVlY2guc3R5bGUubGVmdCA9IHRoaXMuX2NvbmZpZy5mcmFtZVNpemUud2lkdGggKiAwLjc1ICsgJ3B4Jztcblx0fVxuXG5cdHByaXZhdGUgX3NldEZyYW1lKHg6IG51bWJlciwgeTogbnVtYmVyLCBvdmVybGF5OiBudW1iZXIgPSAwKSB7XG5cdFx0Y29uc3QgeyB3aWR0aCwgaGVpZ2h0IH0gPSB0aGlzLl9jb25maWcuZnJhbWVTaXplO1xuXHRcdGNvbnN0IG5vZGUgPSB0aGlzLl9vdmVybGF5cy5jaGlsZHJlbltvdmVybGF5XSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAoeCAlIHdpZHRoICE9PSAwIHx8IHkgJSBoZWlnaHQgIT09IDApIHtcblx0XHRcdGNvbnNvbGUud2FybihgZnJhbWUgJHt4fSwke3l9IGlzIG5vdCBhIG11bHRpcGxlIG9mIGZyYW1lIHNpemUgJHt3aWR0aH0sJHtoZWlnaHR9YCk7XG5cdFx0fVxuXHRcdGlmICghbm9kZSkge1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIG92ZXJsYXkgJHtvdmVybGF5fWApO1xuXHRcdH1cblxuXHRcdG5vZGUuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG5cdFx0bm9kZS5zdHlsZS5iYWNrZ3JvdW5kUG9zaXRpb25YID0gLXggKyAncHgnO1xuXHRcdG5vZGUuc3R5bGUuYmFja2dyb3VuZFBvc2l0aW9uWSA9IC15ICsgJ3B4Jztcblx0XHRub2RlLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblx0XHRub2RlLnN0eWxlLnRvcCA9ICcwJztcblx0XHRub2RlLnN0eWxlLmxlZnQgPSAnMCc7XG5cdH1cblxuXHRwcml2YXRlIF9zZXRGcmFtZXMoaW1hZ2VzOiBGcmFtZUltYWdlcykge1xuXHRcdGlmIChpbWFnZXMpIHtcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgaW1hZ2VzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGNvbnN0IFt4LCB5XSA9IGltYWdlc1tpXTtcblx0XHRcdFx0dGhpcy5fc2V0RnJhbWUoeCwgeSwgaSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG4iLCJ2YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5pbXBvcnQgZ2xvYmFsIGZyb20gJy4vdXRpbC9nbG9iYWwnO1xyXG5jb25zdCBBdWRpb0NvbnRleHQgPSBnbG9iYWwuQXVkaW9Db250ZXh0IHx8IGdsb2JhbC53ZWJraXRBdWRpb0NvbnRleHQ7XHJcbmNvbnN0IG1pbWVNYXAgPSBuZXcgTWFwKFtbJ21wMycsICdhdWRpby9tcGVnJ10sIFsnb2dnJywgJ2F1ZGlvL29nZyddXSk7XHJcbmNvbnN0IGF1ZGlvVGFnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYXVkaW8nKTtcclxuZXhwb3J0IGNsYXNzIFNvdW5kQm9hcmQge1xyXG4gICAgY29uc3RydWN0b3IoY29udGV4dCwgZWZmZWN0cykge1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICAgICAgdGhpcy5lZmZlY3RzID0gZWZmZWN0cztcclxuICAgIH1cclxuICAgIHBsYXkobmFtZSkge1xyXG4gICAgICAgIGNvbnN0IGJ1ZmZlciA9IHRoaXMuZWZmZWN0c1tuYW1lXTtcclxuICAgICAgICBpZiAoYnVmZmVyKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmNvbnRleHQuc3RhdGUgPT09ICdzdXNwZW5kZWQnKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRleHQucmVzdW1lKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgc291cmNlID0gdGhpcy5jb250ZXh0LmNyZWF0ZUJ1ZmZlclNvdXJjZSgpO1xyXG4gICAgICAgICAgICBzb3VyY2UuYnVmZmVyID0gYnVmZmVyO1xyXG4gICAgICAgICAgICBzb3VyY2UuY29ubmVjdCh0aGlzLmNvbnRleHQuZGVzdGluYXRpb24pO1xyXG4gICAgICAgICAgICBzb3VyY2Uuc3RhcnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgU291bmRib2FyZCBtaXNzaW5nIGVmZmVjdCBmb3IgJHtuYW1lfWApO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5leHBvcnQgY2xhc3MgQ29yZUF1ZGlvIHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQgPSBuZXcgQXVkaW9Db250ZXh0KCkpIHtcclxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG4gICAgfVxyXG4gICAgZ2V0IHN1c3BlbmRlZCgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5jb250ZXh0LnN0YXRlID09PSAnc3VzcGVuZGVkJztcclxuICAgIH1cclxuICAgIHJlc3VtZSgpIHtcclxuICAgICAgICB0aGlzLmNvbnRleHQucmVzdW1lKCk7XHJcbiAgICB9XHJcbiAgICBsb2FkKGNvbmZpZykge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVmZmVjdHMgPSB7fTtcclxuICAgICAgICAgICAgT2JqZWN0LmtleXMoY29uZmlnKS5mb3JFYWNoKCh0eXBlKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYWNrID0gY29uZmlnW3R5cGVdO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY2FuUGxheSh0eXBlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdsb2FkaW5nICcgKyB0eXBlKTtcclxuICAgICAgICAgICAgICAgICAgICB5aWVsZCB0aGlzLmxvYWRTb3VuZFBhY2soZWZmZWN0cywgcGFjayk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBTb3VuZEJvYXJkKHRoaXMuY29udGV4dCwgZWZmZWN0cyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBsb2FkU291bmQoc3JjKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IHlpZWxkIGZldGNoKHNyYyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ1ZmZlciA9IHlpZWxkIGRhdGEuYXJyYXlCdWZmZXIoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuY29udGV4dC5kZWNvZGVBdWRpb0RhdGEoYnVmZmVyKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGNhblBsYXkoZm9ybWF0KSB7XHJcbiAgICAgICAgY29uc3QgbWltZXR5cGUgPSBtaW1lTWFwLmdldChmb3JtYXQpIHx8IGZvcm1hdDtcclxuICAgICAgICByZXR1cm4gYXVkaW9UYWcuY2FuUGxheVR5cGUobWltZXR5cGUpO1xyXG4gICAgfVxyXG4gICAgbG9hZFNvdW5kUGFjayhlZmZlY3RzLCBwYWNrKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKE9iamVjdC5rZXlzKHBhY2spLm1hcCgoaWQpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgaWYgKCFlZmZlY3RzW2lkXSkge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICBlZmZlY3RzW2lkXSA9IHlpZWxkIHRoaXMubG9hZFNvdW5kKHBhY2tbaWRdKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKGBmYWlsZWQgdG8gbG9hZCBhdWRpbyAke2lkfWApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpKTtcclxuICAgIH1cclxufVxyXG5leHBvcnQgZGVmYXVsdCBuZXcgQ29yZUF1ZGlvKCk7XHJcbiIsInZhciBnO1xuXG4vLyBUaGlzIHdvcmtzIGluIG5vbi1zdHJpY3QgbW9kZVxuZyA9IChmdW5jdGlvbigpIHtcblx0cmV0dXJuIHRoaXM7XG59KSgpO1xuXG50cnkge1xuXHQvLyBUaGlzIHdvcmtzIGlmIGV2YWwgaXMgYWxsb3dlZCAoc2VlIENTUClcblx0ZyA9IGcgfHwgbmV3IEZ1bmN0aW9uKFwicmV0dXJuIHRoaXNcIikoKTtcbn0gY2F0Y2ggKGUpIHtcblx0Ly8gVGhpcyB3b3JrcyBpZiB0aGUgd2luZG93IHJlZmVyZW5jZSBpcyBhdmFpbGFibGVcblx0aWYgKHR5cGVvZiB3aW5kb3cgPT09IFwib2JqZWN0XCIpIGcgPSB3aW5kb3c7XG59XG5cbi8vIGcgY2FuIHN0aWxsIGJlIHVuZGVmaW5lZCwgYnV0IG5vdGhpbmcgdG8gZG8gYWJvdXQgaXQuLi5cbi8vIFdlIHJldHVybiB1bmRlZmluZWQsIGluc3RlYWQgb2Ygbm90aGluZyBoZXJlLCBzbyBpdCdzXG4vLyBlYXNpZXIgdG8gaGFuZGxlIHRoaXMgY2FzZS4gaWYoIWdsb2JhbCkgeyAuLi59XG5cbm1vZHVsZS5leHBvcnRzID0gZztcbiIsImV4cG9ydCBkZWZhdWx0IFwiOmhvc3Qge1xcblxcdC0tYmctY29sb3I6ICNGRkM7XFxuXFx0LS1ib3JkZXItY29sb3I6IGJsYWNrO1xcblxcdC0tdGV4dC1jb2xvcjogIzMzMztcXG5cXHQtLXRyaWFuZ2xlLWhlaWdodDogMTNweDtcXG5cXHQtLXRyaWFuZ2xlLWJhc2U6IDI2cHg7XFxuXFx0LS10cmlhbmdsZS1wbGFjZW1lbnQ6IDQwcHg7XFxuXFx0LS10cmlhbmdsZS12ZXJ0aWNhbC1wbGFjZW1lbnQ6IDEwcHg7XFxuXFx0LS10cmlhbmdsZS1ib3JkZXI6IDFweDtcXG5cXHQtLXNwZWVjaC1taW4td2lkdGg6IDQwcHg7XFxuXFx0LS1zcGVlY2gtbWluLWhlaWdodDogNDBweDtcXG59XFxuXFxuLnJvb3Qge1xcblxcdHBvc2l0aW9uOiByZWxhdGl2ZTtcXG59XFxuXFxuI292ZXJsYXlzIHtcXG5cXHRwb3NpdGlvbjogcmVsYXRpdmU7XFxufVxcblxcbiNvdmVybGF5cyA+ICoge1xcblxcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG5cXHR0b3A6IDA7XFxuXFx0bGVmdDogMDtcXG59XFxuXFxuLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XFxuICogU1BFRUNIIEJVQkJMRVxcbiovXFxuXFxuI3NwZWVjaCB7XFxuXFx0dmlzaWJpbGl0eTogaGlkZGVuO1xcblxcdHBvc2l0aW9uOiBhYnNvbHV0ZTtcXG5cXHRkaXNwbGF5OiBibG9jaztcXG5cXHR6LWluZGV4OiAxMDAwO1xcblxcdG1pbi13aWR0aDogdmFyKC0tc3BlZWNoLW1pbi13aWR0aCk7XFxuXFx0bWluLWhlaWdodDogdmFyKC0tc3BlZWNoLW1pbi1oZWlnaHQpXFxufVxcblxcbi5idWJibGUge1xcblxcdHBvc2l0aW9uOiByZWxhdGl2ZTtcXG5cXHRwYWRkaW5nOiAxNXB4O1xcblxcdG1hcmdpbjogMWVtIDAgM2VtO1xcblxcdGJvcmRlcjogdmFyKC0tdHJpYW5nbGUtYm9yZGVyKSBzb2xpZCB2YXIoLS1ib3JkZXItY29sb3IpO1xcblxcdGNvbG9yOiB2YXIoLS10ZXh0LWNvbG9yKTtcXG5cXHRiYWNrZ3JvdW5kOiB2YXIoLS1iZy1jb2xvcik7XFxuXFx0Ym9yZGVyLXJhZGl1czogMTBweDtcXG59XFxuXFxuLyogQk9UVE9NIFRSSUFOR0xFICovXFxuXFxuLyogb3V0ZXIgdHJpYW5nbGUgYm9yZGVyICovXFxuLmJvdHRvbS5idWJibGU6YmVmb3JlIHtcXG5cXHRjb250ZW50OiBcXFwiXFxcIjtcXG5cXHRwb3NpdGlvbjogYWJzb2x1dGU7XFxuXFx0Ym90dG9tOiBjYWxjKC0xICogKHZhcigtLXRyaWFuZ2xlLWhlaWdodCkgKyB2YXIoLS10cmlhbmdsZS1ib3JkZXIpKSk7XFxuXFx0bGVmdDogdmFyKC0tdHJpYW5nbGUtcGxhY2VtZW50KTtcXG5cXHRib3JkZXItd2lkdGg6IGNhbGModmFyKC0tdHJpYW5nbGUtaGVpZ2h0KSArIHZhcigtLXRyaWFuZ2xlLWJvcmRlcikpIGNhbGModmFyKC0tdHJpYW5nbGUtYm9yZGVyKSArIHZhcigtLXRyaWFuZ2xlLWJhc2UpIC8gMikgMDtcXG5cXHRib3JkZXItc3R5bGU6IHNvbGlkO1xcblxcdGJvcmRlci1jb2xvcjogdmFyKC0tYm9yZGVyLWNvbG9yKSB0cmFuc3BhcmVudDtcXG59XFxuXFxuLyogY3JlYXRlcyB0aGUgc21hbGxlciAgdHJpYW5nbGUgKi9cXG4uYm90dG9tLmJ1YmJsZTphZnRlciB7XFxuXFx0Y29udGVudDogXFxcIlxcXCI7XFxuXFx0cG9zaXRpb246IGFic29sdXRlO1xcblxcdGJvdHRvbTogY2FsYygtMSAqIHZhcigtLXRyaWFuZ2xlLWhlaWdodCkpO1xcblxcdGxlZnQ6IGNhbGModmFyKC0tdHJpYW5nbGUtcGxhY2VtZW50KSArIHZhcigtLXRyaWFuZ2xlLWJvcmRlcikpO1xcblxcdGJvcmRlci13aWR0aDogdmFyKC0tdHJpYW5nbGUtaGVpZ2h0KSBjYWxjKHZhcigtLXRyaWFuZ2xlLWJhc2UpIC8gMikgMDtcXG5cXHRib3JkZXItc3R5bGU6IHNvbGlkO1xcblxcdGJvcmRlci1jb2xvcjogdmFyKC0tYmctY29sb3IpIHRyYW5zcGFyZW50O1xcbn1cXG5cXG4vKiBMRUZUIFRSSUFOR0xFICovXFxuXFxuLmxlZnQuYnViYmxlOmJlZm9yZSB7XFxuXFx0Y29udGVudDogXFxcIlxcXCI7XFxuXFx0cG9zaXRpb246IGFic29sdXRlO1xcblxcdHRvcDogdmFyKC0tdHJpYW5nbGUtdmVydGljYWwtcGxhY2VtZW50KTtcXG5cXHRsZWZ0OiBjYWxjKC0xICogKHZhcigtLXRyaWFuZ2xlLWhlaWdodCkgKyB2YXIoLS10cmlhbmdsZS1ib3JkZXIpKSk7XFxuXFx0Ym9yZGVyLXdpZHRoOiBjYWxjKHZhcigtLXRyaWFuZ2xlLWJvcmRlcikgKyB2YXIoLS10cmlhbmdsZS1iYXNlKSAvIDIpIGNhbGModmFyKC0tdHJpYW5nbGUtaGVpZ2h0KSArIHZhcigtLXRyaWFuZ2xlLWJvcmRlcikpIGNhbGModmFyKC0tdHJpYW5nbGUtYm9yZGVyKSArIHZhcigtLXRyaWFuZ2xlLWJhc2UpIC8gMikgMDtcXG5cXHRib3JkZXItc3R5bGU6IHNvbGlkO1xcblxcdGJvcmRlci1jb2xvcjogdHJhbnNwYXJlbnQgdmFyKC0tYm9yZGVyLWNvbG9yKSB0cmFuc3BhcmVudDtcXG59XFxuXFxuLmxlZnQuYnViYmxlOmFmdGVyIHtcXG5cXHRjb250ZW50OiBcXFwiXFxcIjtcXG5cXHRwb3NpdGlvbjogYWJzb2x1dGU7XFxuXFx0dG9wOiBjYWxjKHZhcigtLXRyaWFuZ2xlLXZlcnRpY2FsLXBsYWNlbWVudCkgKyB2YXIoLS10cmlhbmdsZS1ib3JkZXIpKTtcXG5cXHRsZWZ0OiBjYWxjKC0xICogdmFyKC0tdHJpYW5nbGUtaGVpZ2h0KSk7XFxuXFx0Ym9yZGVyLXdpZHRoOiA1MHB4IDE0NXB4IDUwcHggMDtcXG5cXHRib3JkZXItd2lkdGg6IGNhbGModmFyKC0tdHJpYW5nbGUtYmFzZSkgLyAyKSB2YXIoLS10cmlhbmdsZS1oZWlnaHQpIGNhbGModmFyKC0tdHJpYW5nbGUtYmFzZSkgLyAyKSAwO1xcblxcdGJvcmRlci1zdHlsZTogc29saWQ7XFxuXFx0Ym9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudCB2YXIoLS1iZy1jb2xvcikgdHJhbnNwYXJlbnQ7XFxufVxcblxcbi8qIFJJR0hUIFRSSUFOR0xFICovXFxuXFxuLyogVE9QIFRSSUFOR0xFICovXFxuXFxuLnNwZWVjaC1idWJibGUtbGVmdDphZnRlciB7XFxuXFx0Y29udGVudDogJyc7XFxuXFx0cG9zaXRpb246IGFic29sdXRlO1xcblxcdHJpZ2h0OiAwO1xcblxcdHRvcDogNTAlO1xcblxcdHdpZHRoOiAwO1xcblxcdGhlaWdodDogMDtcXG5cXHRib3JkZXI6IDIwcHggc29saWQgdHJhbnNwYXJlbnQ7XFxuXFx0Ym9yZGVyLWxlZnQtY29sb3I6ICNmZmZmYmI7XFxuXFx0Ym9yZGVyLXJpZ2h0OiAwO1xcblxcdGJvcmRlci1ib3R0b206IDA7XFxuXFx0bWFyZ2luLXRvcDogLTEwcHg7XFxuXFx0bWFyZ2luLXJpZ2h0OiAtMjBweDtcXG59XFxuXCIiLCJtb2R1bGUuZXhwb3J0cyA9IFwiPGRpdiBjbGFzcz1yb290PiA8ZGl2IGlkPXNwZWVjaCBjbGFzcz1cXFwiYnViYmxlIGxlZnRcXFwiPiA8c2xvdCBuYW1lPVxcXCJcXFwiPiA8L3Nsb3Q+IDwvZGl2PiA8ZGl2IGlkPW92ZXJsYXlzPiA8L2Rpdj4gPC9kaXY+IFwiOyIsImV4cG9ydCBmdW5jdGlvbiBzbGVlcChtaWxsaXNlY29uZHMpIHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgIHNldFRpbWVvdXQocmVzb2x2ZSwgbWlsbGlzZWNvbmRzKTtcclxuICAgIH0pO1xyXG59XHJcbiIsInZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbmltcG9ydCB7IHNsZWVwIH0gZnJvbSAnLi91dGlsL3NsZWVwJztcclxuZnVuY3Rpb24gcGlja1JhbmRvbShicmFuY2hlcykge1xyXG4gICAgbGV0IHBpY2sgPSBNYXRoLnJhbmRvbSgpICogMTAwO1xyXG4gICAgZm9yIChjb25zdCBicmFuY2ggb2YgYnJhbmNoZXMpIHtcclxuICAgICAgICBwaWNrIC09IGJyYW5jaC53ZWlnaHQ7XHJcbiAgICAgICAgaWYgKHBpY2sgPD0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gYnJhbmNoLmZyYW1lSW5kZXg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiogc3RlcHBlcihhbmltYXRpb24pIHtcclxuICAgIGxldCBvZmZzZXQgPSAwO1xyXG4gICAgbGV0IGZyYW1lcyA9IGFuaW1hdGlvbi5mcmFtZXM7XHJcbiAgICBsZXQgZXhpdCA9IGZhbHNlO1xyXG4gICAgd2hpbGUgKG9mZnNldCA8IGZyYW1lcy5sZW5ndGgpIHtcclxuICAgICAgICBsZXQgZnJhbWUgPSBmcmFtZXNbb2Zmc2V0XTtcclxuICAgICAgICBleGl0ID0gISEoeWllbGQgZnJhbWUpIHx8IGV4aXQ7XHJcbiAgICAgICAgaWYgKGV4aXQgJiYgZnJhbWUuZXhpdEJyYW5jaCkge1xyXG4gICAgICAgICAgICBvZmZzZXQgPSBmcmFtZS5leGl0QnJhbmNoO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChmcmFtZS5icmFuY2hpbmcpIHtcclxuICAgICAgICAgICAgb2Zmc2V0ID0gcGlja1JhbmRvbShmcmFtZS5icmFuY2hpbmcuYnJhbmNoZXMpIHx8IG9mZnNldCArIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBvZmZzZXQrKztcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuZXhwb3J0IGZ1bmN0aW9uIGFuaW1hdG9yKGFuaW1hdGlvbiwgZnJhbWVDYWxsYmFjaykge1xyXG4gICAgY29uc3QgaXRlcmF0b3IgPSBzdGVwcGVyKGFuaW1hdGlvbik7XHJcbiAgICBsZXQgZXhpdCA9IGZhbHNlO1xyXG4gICAgbGV0IGltbWVkaWF0ZSA9IGZhbHNlO1xyXG4gICAgbGV0IGNhbGxJbW1lZGlhdGU7XHJcbiAgICBjb25zdCBkb25lID0gUHJvbWlzZS5yYWNlKFtcclxuICAgICAgICAoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCB7IGRvbmUsIHZhbHVlOiBmcmFtZSB9ID0gaXRlcmF0b3IubmV4dChleGl0KTsgIWltbWVkaWF0ZSAmJiAhZG9uZTsgeyBkb25lLCB2YWx1ZTogZnJhbWUgfSA9IGl0ZXJhdG9yLm5leHQoZXhpdCkpIHtcclxuICAgICAgICAgICAgICAgIGZyYW1lQ2FsbGJhY2soZnJhbWUpO1xyXG4gICAgICAgICAgICAgICAgeWllbGQgc2xlZXAoZnJhbWUuZHVyYXRpb24pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpKCksXHJcbiAgICAgICAgbmV3IFByb21pc2UoKHJlc3VsdCkgPT4ge1xyXG4gICAgICAgICAgICBjYWxsSW1tZWRpYXRlID0gcmVzdWx0O1xyXG4gICAgICAgIH0pXHJcbiAgICBdKTtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZG9uZSxcclxuICAgICAgICBzdG9wKCkge1xyXG4gICAgICAgICAgICBleGl0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybiBkb25lO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgc3RvcEltbWVkaWF0ZWx5KCkge1xyXG4gICAgICAgICAgICBpbW1lZGlhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICBjYWxsSW1tZWRpYXRlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG4iLCJpbXBvcnQgeyBBZ2VudCB9IGZyb20gJy4vYWdlbnQnO1xuXG5jdXN0b21FbGVtZW50cy5kZWZpbmUoJ21vZGVybi1hZ2VudCcsIEFnZW50KTtcblxuZXhwb3J0IGRlZmF1bHQgQWdlbnQ7XG4iXSwic291cmNlUm9vdCI6IiJ9